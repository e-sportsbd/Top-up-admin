<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ADMIN PANEL</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
body{
    margin:0;
    background:#f3f4f7;
    font-family:'Poppins',sans-serif;
}

h2{
    text-align:center;
    padding:18px 0;
    background:white;
    margin:0;
    font-weight:600;
    border-bottom:1px solid #ddd;
}

/* CATEGORY CARDS (TOP POPUP) */
.category-box{
    display:flex;
    flex-wrap:wrap;
    justify-content:center;
    gap:12px;
    padding:15px;
}

.cat-card{
    width:130px;
    padding:20px 10px;
    background:white;
    border-radius:12px;
    border:1px solid #dbe0e5;
    text-align:center;
    cursor:pointer;
    font-weight:600;
    color:#1877f2;
    transition:0.2s;
}

.cat-card:hover{
    background:#1877f2;
    color:white;
    box-shadow:0px 3px 8px rgba(0,0,0,0.2);
}

/* PACKAGE TABLE (ALWAYS AT BOTTOM) */
.table-box{
    width:95%;
    margin:20px auto;
    background:white;
    border-radius:12px;
    padding:15px;
    border:1px solid #dcdcdc;
}

.table{
    width:100%;
    border-collapse:collapse;
    margin-top:10px;
}

.table th{
    background:#1877f2;
    color:white;
    padding:10px;
}

.table td{
    border:1px solid #ddd;
    padding:10px;
    text-align:center;
}

.btn-edit{
    background:#ffb703;
    padding:6px 12px;
    border:none;
    border-radius:8px;
    color:black;
    cursor:pointer;
}

.btn-delete{
    background:#e63946;
    padding:6px 12px;
    border:none;
    border-radius:8px;
    color:white;
    cursor:pointer;
}

/* POPUP */
#popupBg{
    display:none;
    position:fixed;
    left:0; top:0;
    width:100%; height:100%;
    background:rgba(0,0,0,0.6);
}

#popup{
    width:90%;
    max-width:380px;
    background:white;
    padding:20px;
    border-radius:12px;
    position:absolute;
    top:50%; left:50%;
    transform:translate(-50%,-50%);
}

input{
    width:100%;
    padding:12px;
    margin-top:10px;
    border-radius:8px;
    border:1px solid #bbb;
}

button{
    width:100%;
    padding:12px;
    margin-top:8px;
    background:#1877f2;
    border:none;
    border-radius:8px;
    color:white;
    font-size:16px;
}

.cancel-btn{
    background:#555;
}

/* BOTTOM CATEGORY TABS */
.bottom-tabs{
    width:95%;
    margin:20px auto;
    display:flex;
    flex-wrap:wrap;
    justify-content:center;
    gap:10px;
}

.bottom-tabs button{
    padding:10px 16px;
    border-radius:8px;
    border:none;
    background:#e8e8e8;
    color:#1877f2;
    font-weight:600;
    cursor:pointer;
    transition:.2s;
}

.bottom-tabs button:hover{
    background:#1877f2;
    color:white;
}
</style>
</head>
<body>

<h2>ðŸ”¥ ADMIN CONTROL PANEL</h2>

<!-- TOP CATEGORY = ONLY POPUP -->
<div class="category-box">
    <div class="cat-card" onclick="addPopup('topup')">Topup</div>
    <div class="cat-card" onclick="addPopup('weekly')">Weekly</div>
    <div class="cat-card" onclick="addPopup('evo')">Evo</div>
    <div class="cat-card" onclick="addPopup('lite')">Lite</div>
    <div class="cat-card" onclick="addPopup('unipin')">Unipin</div>
    <div class="cat-card" onclick="addPopup('levelup')">Level Up</div>
</div>

<!-- BOTTOM CATEGORY = PACKAGE SHOW -->
<div class="bottom-tabs">
    <button onclick="changeCategory('topup')">Topup</button>
    <button onclick="changeCategory('weekly')">Weekly</button>
    <button onclick="changeCategory('evo')">Evo</button>
    <button onclick="changeCategory('lite')">Lite</button>
    <button onclick="changeCategory('unipin')">Unipin</button>
    <button onclick="changeCategory('levelup')">Level Up</button>
</div>

<!-- PACKAGE TABLE ALWAYS AT BOTTOM -->
<div class="table-box">
    <h3>ðŸ“¦ Packages of: <span id="currentCat">topup</span></h3>

    <table class="table" id="packageTable">
        <tr>
            <th>Title</th>
            <th>Diamonds</th>
            <th>Price</th>
            <th>Action</th>
        </tr>
    </table>
</div>

<!-- POPUP -->
<div id="popupBg">
    <div id="popup">
        <h3 id="popupTitle">Add Package</h3>

        <input type="text" id="titleInput" placeholder="Package Title">
        <input type="number" id="diamondInput" placeholder="Diamonds">
        <input type="number" id="priceInput" placeholder="Price">

        <button onclick="savePackage()">Save</button>
        <button class="cancel-btn" onclick="closePopup()">Cancel</button>
    </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
    apiKey: "AIzaSyBl0PIm4lvZea96Bte3KaKQJvurGE1P8Es",
    authDomain: "noreply@post-c7e41.firebaseapp.com",
    databaseURL: "https://post-c7e41-default-rtdb.firebaseio.com",
    projectId: "post-c7e41",
    messagingSenderId: "758133068153",
    appId: "1:758133068153:web:28ef27e45d8037e0d49fa8"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let selectedCat = "topup";
let editId = "";
let editMode = false;

/* TOP POPUP BUTTON */
function addPopup(cat){
    selectedCat = cat;
    document.getElementById("popupTitle").innerText = "Add Package";

    titleInput.value = "";
    diamondInput.value = "";
    priceInput.value = "";

    editMode = false;

    popupBg.style.display = "block";
}

/* BOTTOM CATEGORY BUTTON â†’ SHOW TABLE */
function changeCategory(cat){
    selectedCat = cat;
    document.getElementById("currentCat").innerText = cat;
    loadPackages();
}

/* LOAD PACKAGES AT BOTTOM */
function loadPackages(){
    db.ref("products/"+selectedCat).on("value", snap => {
        let table = document.getElementById("packageTable");
        table.innerHTML = `
            <tr>
                <th>Title</th>
                <th>Diamonds</th>
                <th>Price</th>
                <th>Action</th>
            </tr>
        `;

        snap.forEach(item=>{
            let v = item.val();
            table.innerHTML += `
                <tr>
                    <td>${v.title}</td>
                    <td>${v.diamonds}</td>
                    <td>${v.price}</td>
                    <td>
                        <button class="btn-edit" onclick="editPackage('${item.key}','${v.title}',${v.diamonds},${v.price})">Edit</button>
                        <button class="btn-delete" onclick="deletePackage('${item.key}')">Delete</button>
                    </td>
                </tr>
            `;
        });
    });
}
loadPackages();

/* EDIT PACKAGE */
function editPackage(id,t,d,p){
    editMode = true;
    editId = id;

    popupTitle.innerText = "Edit Package";
    titleInput.value = t;
    diamondInput.value = d;
    priceInput.value = p;

    popupBg.style.display = "block";
}

/* SAVE PACKAGE */
function savePackage(){
    let t = titleInput.value;
    let d = diamondInput.value;
    let p = priceInput.value;

    if(t=="" || d=="" || p=="") return alert("Fill all fields!");

    if(editMode){
        db.ref("products/"+selectedCat+"/"+editId).update({
            title:t,
            diamonds:Number(d),
            price:Number(p)
        });
        alert("Updated!");
    } else {
        db.ref("products/"+selectedCat).push({
            title:t,
            diamonds:Number(d),
            price:Number(p)
        });
        alert("Added!");
    }

    closePopup();
}

/* DELETE */
function deletePackage(id){
    db.ref("products/"+selectedCat+"/"+id).remove();
    alert("Deleted!");
}

/* CLOSE POPUP */
function closePopup(){
    popupBg.style.display="none";
}
</script>

</body>
</html>