<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>User Control Panel</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
body{
    margin:0;
    background:#0d0d0d;
    color:white;
    font-family:'Poppins',sans-serif;
}

.header{
    text-align:center;
    background:#1e90ff;
    padding:15px;
    font-size:22px;
    font-weight:700;
    box-shadow:0 0 10px #000;
}

.container{
    max-width:650px;
    margin:auto;
    padding:15px;
}

.user-box{
    background:#151515;
    border-radius:12px;
    padding:15px;
    margin-top:12px;
    box-shadow:0 0 8px #000;
}

.user-box p{
    margin:4px 0;
}

button{
    padding:8px 12px;
    border:none;
    border-radius:10px;
    margin-right:5px;
    margin-top:5px;
    font-weight:600;
    cursor:pointer;
}

.editBtn{ background:#1e90ff; color:white; }
.banBtn{ background:#ff3b3b; color:white; }
.unbanBtn{ background:#00cc66; color:white; }

input{
    width:90px;
    padding:5px;
    border-radius:8px;
    border:none;
    margin-right:5px;
    margin-top:5px;
    background:#222;
    color:white;
}
</style>
</head>

<body>

<div class="header">USER CONTROL PANEL</div>

<div class="container" id="userList"></div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyBl0PIm4lvZea96Bte3KaKQJvurGE1P8Es",
  authDomain: "post-c7e41.firebaseapp.com",
  databaseURL: "https://post-c7e41-default-rtdb.firebaseio.com/",
  projectId: "post-c7e41"
};
firebase.initializeApp(firebaseConfig);

const db = firebase.database();

// LOAD ALL USERS
db.ref("users").on("value", snap=>{
    let data = snap.val();
    let box = "";

    for(let uid in data){
        let user = data[uid];

        box += `
        <div class="user-box">
            <p><b>Name:</b> ${user.name}</p>
            <p><b>Email:</b> ${user.email}</p>
            <p><b>Phone:</b> ${user.phone}</p>
            <p><b>UID:</b> ${uid}</p>

            <p><b>Status:</b> ${user.ban==true ? "<span style='color:red;'>BANNED</span>" : "<span style='color:#00ff99;'>ACTIVE</span>"}</p>

            <div>
                <input type="number" id="bal_${uid}" placeholder="Amount">
                <button class="editBtn" onclick="updateBalance('${uid}')">Update</button>

                ${user.ban==true 
                    ? `<button class="unbanBtn" onclick="unbanUser('${uid}')">Unban</button>`
                    : `<button class="banBtn" onclick="banUser('${uid}')">Ban</button>`
                }
            </div>
        </div>
        `;
    }

    document.getElementById("userList").innerHTML = box;
});

// UPDATE BALANCE
function updateBalance(uid){
    let amount = document.getElementById("bal_"+uid).value;
    if(amount=="") return alert("Enter amount!");

    db.ref("wallet/"+uid).update({ dollar: Number(amount) });
    alert("Balance Updated!");
}

// BAN USER
function banUser(uid){
    db.ref("users/"+uid).update({ ban:true });
    alert("User Banned!");
}

// UNBAN USER
function unbanUser(uid){
    db.ref("users/"+uid).update({ ban:false });
    alert("User Unbanned!");
}
</script>

</body>
</html>